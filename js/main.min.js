function getWikiData(a,i){"use strict";var t="https://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exintro=&titles=";$.ajax({url:t+arrayLocations[a].name,jsonp:"callback",dataType:"jsonp",timeout:3e3,success:function(t){var n=Object.keys(t.query.pages)[0];arrayLocations[a].wikiData=t.query.pages[n].extract,i()},error:function(){arrayLocations[a].wikiData="There was an error retrieving wiki data.",console.log("Error retrieving wiki data."),i()}})}function initMarker(a){"use strict";var i=new google.maps.Marker({position:arrayLocations[a].mapLoc,map:map,title:arrayLocations[a].name,animation:google.maps.Animation.DROP});arrayMarkers.push(i),i.addListener("click",function(){getWikiData(a,function(){infowindow.setContent(arrayLocations[a].wikiData),infowindow.maxWidth=Math.floor($(window).width()/2),infowindow.open(map,i),i.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){i.setAnimation(null)},750)})})}function initMap(){"use strict";map=new google.maps.Map(document.getElementById("map"),{center:{lat:34.0914,lng:-118.293},zoom:11,disableDefaultUI:!0}),infowindow=new google.maps.InfoWindow({content:"No data set yet."});for(var a=0;a<arrayLocations.length;a++)initMarker(a)}function initIndex(){"use strict";for(var a=0;a<arrayLocations.length;a++)arrayLocations[a].index=a}function AppViewModel(){"use strict";this.allLocations=ko.observableArray(arrayLocations),this.searchTerm=ko.observable(""),this.filteredLocations=ko.computed(function(){return this.allLocations().filter(function(a){return a.name.toLowerCase().indexOf(this.searchTerm().toLowerCase())>-1},this)},this),this.filteredLocations.subscribe(function(){for(var a=0;a<arrayMarkers.length;a++){for(var i=!1,t=0;t<this.filteredLocations().length;t++)if(a===this.filteredLocations()[t].index){i=!0;break}i?arrayMarkers[a].setVisible(!0):arrayMarkers[a].setVisible(!1)}},this),this.displayInfo=function(a){getWikiData(a.index,function(){infowindow.setContent(arrayLocations[a.index].wikiData),infowindow.maxWidth=Math.floor($(window).width()/2),infowindow.open(map,arrayMarkers[a.index]),arrayMarkers[a.index].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){arrayMarkers[a.index].setAnimation(null)},750)})}}var arrayLocations=[{name:"Dodger Stadium",wikiData:"",mapLoc:{lat:34.074,lng:-118.24}},{name:"Walt Disney Concert Hall",wikiData:"",mapLoc:{lat:34.055,lng:-118.25}},{name:"Staples Center",wikiData:"",mapLoc:{lat:34.043,lng:-118.267}},{name:"La Brea Tar Pits",wikiData:"",mapLoc:{lat:34.063,lng:-118.356}},{name:"Bradbury Building",wikiData:"",mapLoc:{lat:34.051,lng:-118.248}},{name:"Hollywood Sign",wikiData:"",mapLoc:{lat:34.134,lng:-118.321}}],infowindow,map,arrayMarkers=[];initIndex(),window.mvvm=new AppViewModel,ko.applyBindings(mvvm),window.addEventListener("load",initMap);