!function(){"use strict";function t(t,i){var n="https://en.wikipedia.org/w/api.php?action=query&prop=extracts&format=json&exintro=&titles=";$.ajax({url:n+s[t].name,jsonp:"callback",dataType:"jsonp",timeout:3e3,success:function(n){var e=Object.keys(n.query.pages)[0];s[t].wikiData=n.query.pages[e].extract,i()},error:function(){s[t].wikiData="There was an error retrieving wiki data.",console.log("Error retrieving wiki data."),i()}})}function i(i){var n=new google.maps.Marker({position:s[i].mapLoc,map:r,title:s[i].name,animation:google.maps.Animation.DROP});l.push(n),n.addListener("click",function(){t(i,function(){o.setContent(s[i].wikiData),o.maxWidth=Math.floor($(window).width()/2),o.open(r,n),n.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){n.setAnimation(null)},750)})})}function n(){r=new google.maps.Map(document.getElementById("map"),{center:{lat:34.0914,lng:-118.293},zoom:11,disableDefaultUI:!0}),o=new google.maps.InfoWindow({content:"No data set yet."});for(var t=0;t<s.length;t++)i(t)}function e(){for(var t=0;t<s.length;t++)s[t].index=t}function a(){this.allLocations=ko.observableArray(s),this.searchTerm=ko.observable(""),this.filteredLocations=ko.computed(function(){return this.allLocations().filter(function(t){return t.name.toLowerCase().indexOf(this.searchTerm().toLowerCase())>-1},this)},this),this.filteredLocations.subscribe(function(){for(var t=0;t<l.length;t++){for(var i=!1,n=0;n<this.filteredLocations().length;n++)if(t===this.filteredLocations()[n].index){i=!0;break}i?l[t].setVisible(!0):l[t].setVisible(!1)}o.close()},this),this.displayInfo=function(i){t(i.index,function(){o.setContent(s[i.index].wikiData),o.maxWidth=Math.floor($(window).width()/2),o.open(r,l[i.index]),l[i.index].setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){l[i.index].setAnimation(null)},750)})}}var o,r,s=[{name:"Dodger Stadium",wikiData:"",mapLoc:{lat:34.074,lng:-118.24}},{name:"Walt Disney Concert Hall",wikiData:"",mapLoc:{lat:34.055,lng:-118.25}},{name:"Staples Center",wikiData:"",mapLoc:{lat:34.043,lng:-118.267}},{name:"La Brea Tar Pits",wikiData:"",mapLoc:{lat:34.063,lng:-118.356}},{name:"Bradbury Building",wikiData:"",mapLoc:{lat:34.051,lng:-118.248}},{name:"Hollywood Sign",wikiData:"",mapLoc:{lat:34.134,lng:-118.321}}],l=[];e(),window.mvvm=new a,ko.applyBindings(mvvm),window.addEventListener("load",n)}();